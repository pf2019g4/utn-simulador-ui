<mat-toolbar color="secundary" *ngIf="escenario && curso">
  <mat-toolbar-row>
    <button mat-icon-button routerLink="/estado-juegos">
      <mat-icon>arrow_back</mat-icon>
    </button>
    <h4>{{escenario.titulo | titlecase}}</h4>
    <mat-chip-list style="margin-left:10px;">
      <mat-chip color="primary" selected>ABIERTO</mat-chip>
    </mat-chip-list>
    <span class="spacer"></span>
    <button mat-raised-button color="warn" (click)="cerrarEscenario()">CERRAR ESCENARIO</button>
  </mat-toolbar-row>
</mat-toolbar>

<mat-tab-group *ngIf="escenario && curso">
  <mat-tab label="Resultados">
    <div class="jugadores-container">
      <mat-card class="general">
        <mat-card-header>
          <mat-card-title>Ranking General</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <mat-list>
            <mat-list-item *ngFor="let jugador of jugadores">
              <div class="ranking-list-item">
                <div class="ranking-list-item-avatar">
                  <img matListAvatar src="../../assets/img/gold-medal.png" style="margin-right: 5px;">
                  <h4 style="font-weight: 400; font-size: inherit;">{{jugador.usuarioNombre}}</h4>
                </div>
                <img *ngIf="jugador.usuarioFotoUrl" matListAvatar src="{{jugador.usuarioFotoUrl}}">
                <img *ngIf="!jugador.usuarioFotoUrl" matListAvatar src="../../assets/img/student.png">
              </div>
            </mat-list-item>
          </mat-list>
        </mat-card-content>
      </mat-card>

      <mat-accordion class="charts-accordion headers-align">
        <mat-expansion-panel expanded="true" hideToggle>
          <mat-expansion-panel-header>
            <mat-panel-title>
              <img src="../../assets/img/ventas.png" class="avatar-img">
              Mejores Ventas
            </mat-panel-title>
            <mat-panel-description>
              <div style="display: flex; margin-right: 20px;">
                <img src="../../assets/img/one.png" class="number-avatar">
                <span>+1000</span>
              </div>
              <div style="display: flex;  margin-right: 20px;">
                <img src="../../assets/img/two.png" class="number-avatar">
                <span>+800</span>
              </div>
              <div style="display: flex;  margin-right: 20px;">
                <img src="../../assets/img/three.png" class="number-avatar">
                <span>+200</span>
              </div>
            </mat-panel-description>
          </mat-expansion-panel-header>
          <div *ngIf="ventasChartProps" class="canvas-container">
            <canvas baseChart [datasets]="ventasChartProps.data" [labels]="ventasChartProps.labels"
              [options]="ventasChartProps.options" [legend]="ventasChartProps.legend"
              [chartType]="ventasChartProps.type">
            </canvas>
          </div>
        </mat-expansion-panel>
        <mat-expansion-panel hideToggle>
          <mat-expansion-panel-header>
            <mat-panel-title>
              <img src="../../assets/img/caja.png" class="avatar-img">
              Mejor Caja Final
            </mat-panel-title>
            <mat-panel-description>
              <div style="display: flex; margin-right: 20px;">
                <img src="../../assets/img/one.png" class="number-avatar">
                <span>+1000</span>
              </div>
              <div style="display: flex;  margin-right: 20px;">
                <img src="../../assets/img/two.png" class="number-avatar">
                <span>+800</span>
              </div>
              <div style="display: flex;  margin-right: 20px;">
                <img src="../../assets/img/three.png" class="number-avatar">
                <span>+200</span>
              </div>
            </mat-panel-description>
          </mat-expansion-panel-header>
          <div class="canvas-container" *ngIf="ventasChartProps">
            <canvas baseChart [datasets]="ventasChartProps.data" [labels]="ventasChartProps.labels"
              [options]="ventasChartProps.options" [legend]="ventasChartProps.legend"
              [chartType]="ventasChartProps.type">
            </canvas>
          </div>
        </mat-expansion-panel>

        <mat-expansion-panel hideToggle>
          <mat-expansion-panel-header>
            <mat-panel-title>
              <img src="../../assets/img/costos.png" class="avatar-img">
              Mejor Renta
            </mat-panel-title>
            <mat-panel-description>
              <div style="display: flex; margin-right: 20px;">
                <img src="../../assets/img/one.png" class="number-avatar">
                <span>+1000</span>
              </div>
              <div style="display: flex;  margin-right: 20px;">
                <img src="../../assets/img/two.png" class="number-avatar">
                <span>+800</span>
              </div>
              <div style="display: flex;  margin-right: 20px;">
                <img src="../../assets/img/three.png" class="number-avatar">
                <span>+200</span>
              </div>
            </mat-panel-description>
          </mat-expansion-panel-header>
          <div class="canvas-container" *ngIf="ventasChartProps">
            <canvas baseChart [datasets]="ventasChartProps.data" [labels]="ventasChartProps.labels"
              [options]="ventasChartProps.options" [legend]="ventasChartProps.legend"
              [chartType]="ventasChartProps.type">
            </canvas>
          </div>
        </mat-expansion-panel>
      </mat-accordion>

    </div>
  </mat-tab>
  <mat-tab label="Jugadores">
    <div class="jugadores-content">
      <mat-card>
        <mat-card-header>
          <mat-card-title>Jugadores</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <mat-list class="jugadores-list">
            <mat-list-item *ngFor="let jugador of jugadores">
              <img *ngIf="jugador.usuarioFotoUrl" matListAvatar src="{{jugador.usuarioFotoUrl}}"
                [className]="jugador.entregado ? 'jugador-entregado' : 'jugador-no-entregado'">
              <img *ngIf="!jugador.usuarioFotoUrl" matListAvatar src="../../assets/img/student.png"
                [className]="jugador.entregado ? 'jugador-entregado' : 'jugador-no-entregado'">
              <h4 mat-line>{{jugador.usuarioNombre}}</h4>
              <p mat-line *ngIf="jugador.entregado" class="jugadores-list-subline">Entregado</p>
              <p mat-line *ngIf="!jugador.entregado" class="jugadores-list-subline">No Entregado</p>
            </mat-list-item>
          </mat-list>
        </mat-card-content>
      </mat-card>
    </div>
  </mat-tab>

  <mat-tab label="Tabla Ponderadora">
    <div class="tabla-ponderadora-content">
      <mat-card class="forecast" *ngIf="configuracionMercado.mercadosPeriodo">
        <mat-card-header>
          <div mat-card-avatar class="ventas-avatar"></div>
          <mat-card-title>Demanda de Mercado</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <table class="mat-table table">
            <tr class="mat-header-row">
              <th class="mat-header-cell desc-column">Valor</th>
              <th class="mat-header-cell value-column-cantidad">Bajo</th>
              <th class="mat-header-cell value-column-cantidad">Medio</th>
              <th class="mat-header-cell value-column-cantidad">Alto</th>
            </tr>
            <ng-container *ngFor="let forecast of configuracionMercado.mercadosPeriodo">
              <tr class="mat-row">
                <td class="mat-cell">
                  <span>{{escenario.nombrePeriodos}} {{forecast.periodo}}</span>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="forecast.bajo" [(value)]="forecast.bajo" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="forecast.medio" [(value)]="forecast.medio" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="forecast.alto" [(value)]="forecast.alto" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
              </tr>
            </ng-container>
          </table>
        </mat-card-content>
      </mat-card>
      <mat-card class="empresas" *ngIf="configuracionMercado.empresasCompetidoras">
        <mat-card-header>
          <div mat-card-avatar class="competencia-avatar"></div>
          <mat-card-title>Empresas Competidoras</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <table class="mat-table table">
            <tr class="mat-header-row">
              <th class="mat-header-cell desc-column">Empresa</th>
              <th class="mat-header-cell value-column-cantidad">Bajo</th>
              <th class="mat-header-cell value-column-cantidad">Medio</th>
              <th class="mat-header-cell value-column-cantidad">Alto</th>
            </tr>
            <ng-container *ngFor="let ec of configuracionMercado.empresasCompetidoras">
              <tr class="mat-row">
                <td class="mat-cell">
                  <mat-form-field>
                    <input [(ngModel)]="ec.nombre" [(value)]="ec.nombre" matInput>
                  </mat-form-field>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="ec.bajo" [(value)]="ec.bajo" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="ec.medio" [(value)]="ec.medio" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="ec.alto" [(value)]="ec.alto" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
              </tr>
            </ng-container>
          </table>
        </mat-card-content>
      </mat-card>
      <mat-card class="precio-intervalo" *ngIf="configuracionMercado.restriccionPrecio">
        <mat-card-header>
          <div mat-card-avatar class="precio-avatar"></div>
          <mat-card-title>Intervalo de Precios</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="precio-intervalo-container">
            <mat-form-field>
              <input placeholder="Precio Min" type="number" matInput
                [(ngModel)]="configuracionMercado.restriccionPrecio.precioMin"
                [(value)]="configuracionMercado.restriccionPrecio.precioMin">
            </mat-form-field>
            <span style="margin-right: 20px; margin-left: 20px;">hasta</span>
            <mat-form-field>
              <input placeholder="Precio Max" type="number" matInput
                [(ngModel)]="configuracionMercado.restriccionPrecio.precioMax"
                [(value)]="configuracionMercado.restriccionPrecio.precioMax">
            </mat-form-field>
          </div>
        </mat-card-content>
      </mat-card>
      <mat-accordion class="accordion-tables headers-align" *ngIf="configuracionMercado.ponderacionesMercado">
        <mat-expansion-panel hideToggle expanded="true">
          <mat-expansion-panel-header>
            <mat-panel-title>
              <img src="../../assets/img/precio.png" class="avatar-img">
              Precio Desde
            </mat-panel-title>

          </mat-expansion-panel-header>

          <table class="mat-table table">
            <tr class="mat-header-row">
              <th class="mat-header-cell desc-column">Valor</th>
              <th class="mat-header-cell value-column-cantidad">Bajo</th>
              <th class="mat-header-cell value-column-cantidad">Medio</th>
              <th class="mat-header-cell value-column-cantidad">Alto</th>
            </tr>
            <ng-container *ngFor="let pd of configuracionMercado.ponderacionesMercado.precioDesde">
              <tr class="mat-row">
                <td class="mat-cell">
                  <mat-form-field>
                    <input type="number" matInput [(ngModel)]="pd.valor" [(value)]="pd.valor">
                  </mat-form-field>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="pd.bajo" [(value)]="pd.bajo" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="pd.medio" [(value)]="pd.medio" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="pd.alto" [(value)]="pd.alto" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
              </tr>
            </ng-container>
          </table>
        </mat-expansion-panel>
        <mat-expansion-panel hideToggle>
          <mat-expansion-panel-header>
            <mat-panel-title>
              <img src="../../assets/img/cobro.png" class="avatar-img">
              Modalidad de Cobro
            </mat-panel-title>

          </mat-expansion-panel-header>
          <table class="mat-table table">
            <tr class="mat-header-row">
              <th class="mat-header-cell desc-column">Valor</th>
              <th class="mat-header-cell value-column-cantidad">Bajo</th>
              <th class="mat-header-cell value-column-cantidad">Medio</th>
              <th class="mat-header-cell value-column-cantidad">Alto</th>
            </tr>
            <ng-container *ngFor="let mc of configuracionMercado.ponderacionesMercado.modalidadCobro">
              <tr class="mat-row">
                <td class="mat-cell">
                  <span>{{getModalidadCobroDesc(mc.valor)}}</span>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="mc.bajo" [(value)]="mc.bajo" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="mc.medio" [(value)]="mc.medio" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="mc.alto" [(value)]="mc.alto" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
              </tr>
            </ng-container>
          </table>
        </mat-expansion-panel>
        <mat-expansion-panel hideToggle>
          <mat-expansion-panel-header>
            <mat-panel-title>
              <img src="../../assets/img/calidad.png" class="avatar-img">
              Calidad Desde
            </mat-panel-title>

          </mat-expansion-panel-header>
          <table class="mat-table table">
            <tr class="mat-header-row">
              <th class="mat-header-cell desc-column">Valor</th>
              <th class="mat-header-cell value-column-cantidad">Bajo</th>
              <th class="mat-header-cell value-column-cantidad">Medio</th>
              <th class="mat-header-cell value-column-cantidad">Alto</th>
            </tr>
            <ng-container *ngFor="let cd of configuracionMercado.ponderacionesMercado.calidadDesde">
              <tr class="mat-row">
                <td class="mat-cell">
                  <mat-form-field>
                    <input type="number" matInput [(ngModel)]="cd.valor" [(value)]="cd.valor">
                  </mat-form-field>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="cd.bajo" [(value)]="cd.bajo" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="cd.medio" [(value)]="cd.medio" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="cd.alto" [(value)]="cd.alto" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
              </tr>
            </ng-container>
          </table>
        </mat-expansion-panel>
        <mat-expansion-panel hideToggle>
          <mat-expansion-panel-header>
            <mat-panel-title>
              <img src="../../assets/img/teamwork.png" class="avatar-img">
              Vendedores Desde
            </mat-panel-title>

          </mat-expansion-panel-header>
          <table class="mat-table table">
            <tr class="mat-header-row">
              <th class="mat-header-cell desc-column">Valor</th>
              <th class="mat-header-cell value-column-cantidad">Bajo</th>
              <th class="mat-header-cell value-column-cantidad">Medio</th>
              <th class="mat-header-cell value-column-cantidad">Alto</th>
            </tr>
            <ng-container *ngFor="let vd of configuracionMercado.ponderacionesMercado.vendedoresDesde">
              <tr class="mat-row">
                <td class="mat-cell">
                  <mat-form-field>
                    <input type="number" matInput [(ngModel)]="vd.valor" [(value)]="vd.valor">
                  </mat-form-field>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="vd.bajo" [(value)]="vd.bajo" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="vd.medio" [(value)]="vd.medio" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="vd.alto" [(value)]="vd.alto" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
              </tr>
            </ng-container>
          </table>
        </mat-expansion-panel>
        <mat-expansion-panel hideToggle>
          <mat-expansion-panel-header>
            <mat-panel-title>
              <img src="../../assets/img/publicity.png" class="avatar-img">
              Publicidad Desde
            </mat-panel-title>

          </mat-expansion-panel-header>
          <table class="mat-table table">
            <tr class="mat-header-row">
              <th class="mat-header-cell desc-column">Valor</th>
              <th class="mat-header-cell value-column-cantidad">Bajo</th>
              <th class="mat-header-cell value-column-cantidad">Medio</th>
              <th class="mat-header-cell value-column-cantidad">Alto</th>
            </tr>
            <ng-container *ngFor="let pd of configuracionMercado.ponderacionesMercado.publicidadDesde">
              <tr class="mat-row">
                <td class="mat-cell">
                  <mat-form-field>
                    <input type="number" matInput [(ngModel)]="pd.valor" [(value)]="pd.valor">
                  </mat-form-field>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="pd.bajo" [(value)]="pd.bajo" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="pd.medio" [(value)]="pd.medio" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
                <td class="mat-cell value-column-cantidad">
                  <mat-form-field style="text-align: right;width: 80px;">
                    <input type="number" [(ngModel)]="pd.alto" [(value)]="pd.alto" matInput
                      style="text-align: right;width: 80px;">
                  </mat-form-field>
                </td>
              </tr>
            </ng-container>
          </table>
        </mat-expansion-panel>
      </mat-accordion>
    </div>
  </mat-tab>

</mat-tab-group>